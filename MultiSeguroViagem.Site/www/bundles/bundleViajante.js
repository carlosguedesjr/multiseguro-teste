calculaDigitosCpf=function(a){if(s=a,isNaN(s))return!1;for(var t=!1,r=1,e=0;e<s.length;e++)r<s.length&&s.charAt(e)!=s.charAt(r)&&(t=!0),r++;if(!t)return!1;var e,n=s.substr(0,9),i=s.substr(9,2),o=0;for(e=0;e<9;e++)o+=n.charAt(e)*(10-e);if(0==o)return!1;if(o=11-o%11,o>9&&(o=0),i.charAt(0)!=o)return!1;for(o*=2,e=0;e<9;e++)o+=n.charAt(e)*(11-e);return o=11-o%11,o>9&&(o=0),i.charAt(1)==o},calculoDigitosCnpj=function(a){if(s=a,isNaN(s))return!1;var t,r=s.substr(0,12),e=s.substr(12,2),n=0;for(t=0;t<12;t++)n+=r.charAt(11-t)*(2+t%8);if(0==n)return!1;if(n=11-n%11,n>9&&(n=0),e.charAt(0)!=n)return!1;for(n*=2,t=0;t<12;t++)n+=r.charAt(11-t)*(2+(t+1)%8);return n=11-n%11,n>9&&(n=0),e.charAt(1)==n},campoVazio=function(a){return""===$(a).val()||null===$(a).val()?($('span[data-valmsg-for="'+$(a).attr("name")+'"]').text($(a).attr("data-message-empty")),!1):($('span[data-valmsg-for="'+$(a).attr("name")+'"]').text(""),!0)},nomeCompleto=function(a){var t=/([A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ]{2,}([ A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ'`.]{0,}?)[ ]{1,}([ A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ'`]{0,}?)[A-Za-záàâãéèêíïóôõöúçñÁÀÂÃÉÈÍÏÓÔÕÖÚÇÑ]{2,})/;return a.value.match(t)&&""!=a.value?($('span[data-valmsg-for="'+$(a).attr("name")+'"]').text(""),!0):($('span[data-valmsg-for="'+$(a).attr("name")+'"]').text("Digite o nome completo"),!1)},data=function(a){var t=/^((((0?[1-9]|[12]\d|3[01])[\.\-\/](0?[13578]|1[02])[\.\-\/]((1[6-9]|[2-9]\d)?\d{2}))|((0?[1-9]|[12]\d|30)[\.\-\/](0?[13456789]|1[012])[\.\-\/]((1[6-9]|[2-9]\d)?\d{2}))|((0?[1-9]|1\d|2[0-8])[\.\-\/]0?2[\.\-\/]((1[6-9]|[2-9]\d)?\d{2}))|(29[\.\-\/]0?2[\.\-\/]((1[6-9]|[2-9]\d)?(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00)|00)))|(((0[1-9]|[12]\d|3[01])(0[13578]|1[02])((1[6-9]|[2-9]\d)?\d{2}))|((0[1-9]|[12]\d|30)(0[13456789]|1[012])((1[6-9]|[2-9]\d)?\d{2}))|((0[1-9]|1\d|2[0-8])02((1[6-9]|[2-9]\d)?\d{2}))|(2902((1[6-9]|[2-9]\d)?(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00)|00))))$/;return a.value.match(t)&&""!=a.value?($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text(""),!0):($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text("Data inválida"),!1)},cpf=function(a){var t=a.value.replace(/\D+/g,"");return calculaDigitosCpf(t)?($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text(""),!0):($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text("CPF inválido"),!1)},cnpj=function(a){var t=a.value.replace(/\D+/g,"");return calculoDigitosCnpj(t)?($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text(""),!0):($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text("CNPJ inválido"),!1)},cpfCnpj=function(a){var t=a.value.replace(/\D+/g,"");return 11==t.length?cpf(a):t.length>=14?cnpj(a):($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text("Documento inválido"),!1)},email=function(a){return $(a).val().match(/(?:[a-z0-9!#$%&'*+\=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)/gi)?($('span[data-valmsg-for="'+$(a).attr("name")+'"]').text(""),!0):($('span[data-valmsg-for="'+$(a).attr("name")+'"]').text("E-mail inválido"),!1)},idadeMaximaPlano=function(a){var t=$(a).attr("id").replace(/[^\d]/g,""),r=parseInt($("#hdnIdadeMaximaPlano"+t).val())||0,e=(new Date).getFullYear()-(parseInt($(a).val().split("/")[2])||0),n=new Date($(a).val().split("/").reverse());return n.setHours(0,0,0,0),e>r||n>new Date?($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text("Idade superior a idade máxima do plano"),!1):($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text(""),!0)},idadeMinimaPlano=function(a){return(new Date).getFullYear()-(parseInt($(a).val().split("/")[2])||0)<0?($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text("Idade inferior a idade mínima do plano"),!1):($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text(""),!0)},viajanteDuplicado=function(a){var t=$(a).attr("id").replace(/\D/g,""),r=$("#Nome"+t).val();return $("#lista-viajantes").find("div[class*='viajante']").has("input[name*='Nome']:valueEquals("+r+")").has("input[name*='Cpf']:valueEquals("+$(a).val()+")").length>1?($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text("Viajante duplicado"),!1):($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text(""),!0)},camposDiferentes=function(a){var t=$(a).attr("data-target-camposdiferentes");return $(a).val()===$(t).val()?($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text($(a).attr("data-message-camposdiferentes")),!1):($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text(""),!0)},campoChecado=function(a){return $(a).is(":checked")?($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text(""),!0):($('span[data-valmsg-for="'+$(a).attr("id")+'"]').text($(a).attr("data-message-checked")),!1)},validaCampo=function(a,t){var r=!0,e=!0;return $(a).attr("valida").split(" ").map(function(t){if(e){var n=window[t];return"function"!=typeof n||n(a)?void 0:(r=!1,void(e=!1))}}),$((t||"")+" .valid:has(label.control-label span.control-label:not(:empty))").has(a).removeClass("has-success").addClass("has-error"),$((t||"")+" .valid:has(label.control-label span.control-label:empty)").has(a).removeClass("has-error").addClass("has-success"),r},validaFormulario=function(a){var t=!0,r=void 0;return r=a+" [valida]",$(r).each(function(r,e){validaCampo(e,a)||(t=!1)}),t},validacao=function(a,t){t=t||{};var r="botao"in t?$(t.botao):$(a+' button[type="submit"]'),e="submit"===r.attr("type")?$(a):r,n="submit"===r.attr("type")?"submit":"click";$(a).on("blur keyup change",':input[valida]:not(:button), :input[data-toggle="dropdown"]',function(t){var r=t.target;"dropdown"==$(r).attr("data-toggle")&&(r="#"+$(r).attr("data-id")),validaCampo(r,a)}),e.on(n,function(e){r.button("loading"),validaFormulario(a)?"submit"in t&&t.submit(e):("invalido"in t&&t.invalido(e),e.preventDefault(),r.button("reset"))})};
function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),Intencao=function(){function t(e,n,a,r,i,o){_classCallCheck(this,t),this.destino=e,this.dataIda=n,this.dataVolta=a,this.email=r,this.origem=i,this.referrer=o,this.ip=this.obtemIp()}return _createClass(t,[{key:"obtemIp",value:function(){var t=void 0;return $.ajax({url:"https://api.ipify.org",async:!1}).done(function(e){t=e}),t}}]),t}();
function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var IntencaoCompra=function(t){function e(t,n,o,r,a,i,c,s){_classCallCheck(this,e);var u=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o,r,a,i));u.viajantes=[];var l=u;return c.map(function(t){return l.viajantes.push(new Viajante(t.Nome,t.Cpf,t.DataNascimento,t.Sexo,t.ValorUnitario,s))}),u}return _inherits(e,t),e}(Intencao);
function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,a){for(var t=0;t<a.length;t++){var n=a[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(a,t,n){return t&&e(a.prototype,t),n&&e(a,n),a}}(),Viajante=function(){function e(a,t,n,r,i){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"";_classCallCheck(this,e),this.Nome=a,this.Cpf=t,this.DataNascimento=n,this.Sexo=r,this.ValorUnitario=parseFloat(i)||0,this.Plano=l}return _createClass(e,null,[{key:"calculaIdade",value:function(e,a){var t=e.split("/"),n=new Date(parseInt(t[2],10),parseInt(t[1],10)-1,parseInt(t[0],10)),r=a.split("/"),a=new Date(parseInt(r[2],10),parseInt(r[1],10)-1,parseInt(r[0],10)),i=a.getTime()-n.getTime(),l=new Date(i);return l=Math.abs(l.getUTCFullYear()-1970)}}]),e}();
templateViajanteDesktop=function(a){return'        \n        <div class="row viajante-'+a+'">\n            <div class="col-md-3 valid">\n                <input id="hdnValorUnitario'+a+'" name="hdnValorUnitario'+a+'" type="hidden" value="">\n                <div class="form-group ">\n                    <label class="control-label">\n                        <span data-valmsg-for="Nome'+a+'" class="control-label" data-valmsg-replace="true"></span>\n                    </label>\n                </div>\n                <div class="input-group">\n                    <span class="input-group-addon">\n                        <i class="material-icons">account_circle</i>\n                    </span>\n                    <input id="Nome'+a+'" name="Nome'+a+'" class="form-control" data-message-empty="Informe o nome" valida="campoVazio nomeCompleto" maxlength="100" placeholder="Nome completo" type="text" value="">\n                </div>\n            </div>\n\n            <div class="col-md-3 valid">\n                <div class="form-group ">\n                    <label class="control-label">\n                        <span data-valmsg-for="DataNascimento'+a+'" class="control-label" data-valmsg-replace="true"></span>\n                    </label>\n                </div>\n                <div class="input-group">\n                    <span class="input-group-addon">\n                        <i class="material-icons">date_range</i>\n                    </span>\n                    <input id="hdnIdadeMaximaPlano'+a+'" type="hidden" value="">\n                    <input class="form-control" id="DataNascimento'+a+'" name="DataNascimento'+a+'" type="text" value="" maxlength="10" data-message-empty="Informe a data de nascimento" valida="campoVazio data idadeMaximaPlano idadeMinimaPlano" mask-data-nascimento="true" placeholder="Data de Nasc.">\n                </div>\n            </div>\n\n            <div class="col-md-3 valid">\n                <div class="form-group ">\n                    <label class="control-label">\n                        <span data-valmsg-for="Cpf'+a+'" class="control-label" data-valmsg-replace="true"></span>\n                    </label>\n                </div>\n                <div class="input-group">\n                    <span class="input-group-addon">\n                        <i class="material-icons">insert_drive_file</i>\n                    </span>\n                    <input id="Cpf'+a+'" name="Cpf'+a+'" class="form-control" data-message-empty="Informe o CPF" valida="campoVazio cpf viajanteDuplicado" mask-cpf="true" placeholder="CPF" type="text" value="" maxlength="14">\n                </div>\n            </div>        \n\n            <div class="col-md-2 valid">\n                <div class="form-group ">\n                    <label class="control-label">\n                        <span data-valmsg-for="Sexo'+a+'" class="control-label" data-valmsg-replace="true"></span>\n                    </label>\n                </div>\n                <div class="input-group">\n                    <span class="input-group-addon">\n                        <i class="material-icons">wc</i>\n                    </span>\n                    <div class="form-group select-button">\n                        <select id="Sexo'+a+'" name="Sexo'+a+'" class="selectpicker" data-message-empty="Informe o sexo" valida="campoVazio" data-style="form-control" title="Sexo" tabindex="-98">\n                            <option class="bs-title-option" value="">Sexo</option>\n                            <option disabled="disabled">Selecione seu sexo</option>\n                            <option value="M">Masculino</option>\n                            <option value="F">Feminino</option>\n                        </select>\n                    </div>\n                </div>\n            </div>\n\n            <div class="col-md-1">\n                <button title="Remover viajante" class="btn btn-simple btn-danger remover-viajante" value="'+a+'">\n                    <i class="material-icons hidden-xs hidden-sm">cancel</i> <i class="material-icons hidden-md hidden-lg">remove</i> <span class="hidden-md hidden-lg">Remover viajante</span>\n                </button>\n            </div>            \n        </div>\n    '},templateAlerta=function(a,e){var o={person:'<i class="material-icons">person</i>',error:'<i class="material-icons">error_outline</i>'};return'\n        <div class="row">\n            <div class="alert alert-'+("error"===e?"danger":"info")+'">\n                <div class="container-fluid">\n                    <div class="alert-icon">\n                        '+o[e]+"\n                    </div>\n                    "+a+"\n                </div>\n            </div>\n        </div>\n    "},renderTemplateViajanteDesktop=function(a,e){var o=templateViajanteDesktop(e);$(a).append(o),$("#Sexo"+e+".selectpicker").selectpicker("refresh"),mascaraDataNascimento(),mascaraCpf(),removeViajanteDesktop(e),adicionaViajanteDesktop(e),$("#contador").val(e),1==e&&$('.remover-viajante[value="1"]').addClass("hidden"),isMobile(navigator.userAgent)&&($('.remover-viajante[value="'+e+'"]').removeClass("btn-simple"),$('.remover-viajante[value="'+e+'"]').addClass("btn-block"))},rendertemplateAlerta=function(a,e,o){var n=templateAlerta(e,o);$(a).empty().append(n)},validaIdadeMaximaDoPlano=function(a,e,o){return a>(o||e)},validaMelhorIdade=function(a,e,o){return 0!=e&&(a>=e&&a<=o)},validaReferrer=function(){if(document.referrer.toLowerCase().indexOf("cotador/comparador")<=0&&document.referrer.toLowerCase().indexOf("cotador/cotacao")<=0){var a=getParseSession("cotacao"),e=void 0;e=a?"/Cotador/Cotacao?Destino="+a.Destino+"&DataIda="+a.DataIda+"&DataVolta="+a.DataVolta:"/Home/Index",window.location.href=e}},atualizaValorTotal=function(a){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"+",o=arguments[2],n=parseFloat($(".preco-total span").text())||0,t=parseFloat($("#hdnValorUnitario"+o).val())||0,l=(parseFloat(a)||0)*parseInt(e+"1");n+=l,t+=l,$(".preco-total span").text(n.toFixed(2)),$("#hdnValorUnitario"+o).val(t.toFixed(2))},adicionaViajanteDesktop=function(a){var e=getParseSession("cotacao"),o=planoSelecionado,n=!1;$("#hdnIdadeMaximaPlano"+a).val(o.MelhorIdadeMaxima||o.IdadeMaxima),$("#DataNascimento"+a).on("blur",function(t){if($(".msg-alerta").empty(),!$("#DataNascimento"+a).val())return!1;var l=($("#DataNascimento"+a).val().split("/")[2],e.DataIda.split("/")[2],$("#DataNascimento"+a).val()),i=e.DataIda,r=Viajante.calculaIdade(l,i);if(validaIdadeMaximaDoPlano(r,o.IdadeMaxima,o.MelhorIdadeMaxima)||r<0)return rendertemplateAlerta($(".msg-alerta"),"A idade do viajante não é suportada pelo plano. Ajuste a idade ou volte e escolha outro plano!","error"),n=!1,!1;var s=validaMelhorIdade(r,o.MelhorIdadeMinima,o.MelhorIdadeMaxima),d=parseFloat(o.PrecoMelhorIdade)-parseFloat(o.PrecoComercial)||0;if(n!==s){n=s;var c=void 0;c=s?"+":"-",atualizaValorTotal(d||parseFloat(o.PrecoComercial.replace(",",".")),c,a)}s&&rendertemplateAlerta($(".msg-alerta"),"A idade do viajante é superior à "+o.MelhorIdadeMinima+" anos. Devido a isso, será acrescido o valor de R$ "+d.toFixed(2)+" conforme condições da operadora.","person")}),atualizaValorTotal(o.PrecoComercial.replace(",","."),"+",a)},removeViajanteDesktop=function(a){$('.remover-viajante[value="'+a+'"]').on("click",function(e){var o=$("#hdnValorUnitario"+a).val()||0;atualizaValorTotal(o,"-",a),$(".viajante-"+e.currentTarget.value).remove(),$(".msg-alerta").empty(),$("#contador").val(parseInt($("#contador").val())-1),isMobile(navigator.userAgent)&&$("#lista-viajantes .viajante-"+(a-1)).removeClass("hidden")})},planoSelecionado=function(a){var e=parseInt(obtemParametroUriMvc(3))||0,o=getParseSession("cotacao"),n=void 0;if(o.Planos.map(function(a){e===a.IdPlano&&(a.MelhorIdadeValorAcrescimo=a.MelhorIdadeValorAcrescimo.replace(",","."),a.Preco=a.Preco.replace(",","."),a.PrecoComercial=a.PrecoComercial.replace(",","."),a.PrecoMelhorIdade=a.PrecoMelhorIdade.replace(",","."),n=a)}),void 0!=n)return n;var t=a+o.Destino+"&DataIda="+o.DataIda+"&DataVolta="+o.DataVolta;window.location.href=t},setaDescricaoViajantes=function(){var a=getParseSession("cotacao"),e={1:"América do Norte",2:"África",3:"América Central",4:"América do Sul",5:"Ásia",6:"Brasil",7:"Europa",8:"Oceania",9:"Oriente Médio"};$("#destino").text(e[a.Destino]),$("#dataIda").text(a.DataIda),$("#dataVolta").text(a.DataVolta),$("#Plano").text(planoSelecionado.Operadora.Nome+" - "+planoSelecionado.Nome)};
function _classCallCheck(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,n.key,n)}}return function(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}}(),Carrinho=function(){function a(t,e,n,i){_classCallCheck(this,a),this.Dias=this.calculaDias(e,n),this.QuantidadeViajantes=parseInt(t)||0,this.DataIda=e,this.DataVolta=n,this.ValorTotal=0,this.Planos=i,this.Viajantes=[],this.populaViajantes()}return _createClass(a,[{key:"salva",value:function(){var a=[];a.push(this),setSession("carrinho",JSON.stringify(a))}},{key:"calculaDias",value:function(a,t){a=a.split("/");var e=new Date(a[2],a[1]-1,a[0]);t=t.split("/");var n=new Date(t[2],t[1]-1,t[0]);return Math.round((n-e)/864e5)+1}},{key:"populaViajantes",value:function(){for(var a=1;a<=this.QuantidadeViajantes;a++){var t=$("#Nome"+a).val(),e=$("#DataNascimento"+a).val(),n=$("#Cpf"+a).val(),i=$("#Sexo"+a).val(),s=$("#hdnValorUnitario"+a).val();this.ValorTotal+=parseFloat(s)||0,this.Viajantes.push(new Viajante(t,n,e,i,s))}}}]),a}();